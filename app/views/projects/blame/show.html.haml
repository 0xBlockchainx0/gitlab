- page_title "Blame", @blob.path, @ref
- link_icon = icon("link")

#blob-content-holder.tree-holder
  = render "projects/blob/breadcrumb", blob: @blob, blame: true

  .file-holder
    = render "projects/blob/header", blob: @blob, blame: true
    .file-blame-legend
      = render 'age_map_legend'
    .table-responsive.file-content.blame.code.js-syntax-highlight
      %table
        - current_line = 1
        - @blame.groups.each do |blame_group|
          - commit_id = blame_group[:commit].id
          - commit_data = @blame.commit_data(commit_id)

          = render 'blame_group',
            blame_group: blame_group,
            current_line: current_line,
            link_icon: link_icon,
            author_avatar: commit_data.author_avatar,
            age_map_class: commit_data.age_map_class,
            commit_link: commit_data.commit_link,
            commit_author_link: commit_data.commit_author_link,
            project_blame_link: commit_data.project_blame_link,
            time_ago_tooltip: commit_data.time_ago_tooltip

          - current_line += blame_group[:lines].count
