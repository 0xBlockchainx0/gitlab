# frozen_string_literal: true

module Resolvers
  class VulnerabilityFindingsResolver < BaseResolver
    include Gitlab::Utils::StrongMemoize

    type Types::VulnerabilityFindingType, null: true

    def resolve(**args)
      return Vulnerabilities::Occurrence.none unless vulnerability

      vulnerability.findings
    end

    private

    def vulnerability
      strong_memoize(:vulnerability) do
        object.respond_to?(:sync) ? object.sync : object
      end
    end
  end
end
