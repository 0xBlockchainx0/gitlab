# frozen_string_literal: true

module VulnerabilityIssueLinks
  class DeleteService < BaseService
    def initialize(user, vulnerability_issue_link)
      @user = user
      @link = vulnerability_issue_link
    end

    def execute
      raise Gitlab::Access::AccessDeniedError unless can?(@user, :admin_vulnerability_issue_link, @link)

      @link.destroy!

      success
    end

    private

    def success
      ServiceResponse.success(payload: { record: @link }, http_status: 204)
    end
  end
end
