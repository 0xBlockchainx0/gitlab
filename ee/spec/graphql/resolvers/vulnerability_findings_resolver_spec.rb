# frozen_string_literal: true

require 'spec_helper'

describe Resolvers::VulnerabilityFindingsResolver do
  include GraphqlHelpers

  describe '#resolve' do
    let_it_be(:project) { create(:project) }

    let_it_be(:vulnerability) { create(:vulnerability, :with_findings, project: project) }

    subject { resolve(described_class, obj: vulnerability, args: {}) }

    it "returns the vulnerability's findings" do
      is_expected.to contain_exactly(*vulnerability.findings)
    end
  end
end
