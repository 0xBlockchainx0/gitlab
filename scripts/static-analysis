#!/usr/bin/env ruby

# We don't have auto-loading here
require_relative '../lib/gitlab/popen'
require_relative '../lib/gitlab/popen/runner'

tasks = [
  %w[ruby -rbundler/setup scripts/ee_specific_check/ee_specific_check.rb],
  %w[bin/rake lint:all],
  %w[bundle exec license_finder],
  %w[yarn run eslint],
  %w[yarn run stylelint],
  %w[yarn run prettier-all],
  %w[bundle exec rubocop --parallel],
  %w[scripts/lint-conflicts.sh],
  %w[scripts/lint-rugged]
]

tasks.each do |task|
  cmd = task.join(' ')
  puts "$ #{cmd}"
  result = system(cmd)

  unless result
    puts "#{cmd} failed!"
    exit 1
  end
end
